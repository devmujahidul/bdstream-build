var t,e,s,i,a,n,h,l,r,c,o,u,d,f,p,g,y,k,b,v,m,w,M,T,$,W,P,C,j,q,E,R,O,Q,V,x,I,A,D,S,F,L=Object.defineProperty,B=t=>{throw TypeError(t)},N=(t,e,s)=>((t,e,s)=>e in t?L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s),_=(t,e,s)=>e.has(t)||B("Cannot "+s),K=(t,e,s)=>(_(t,e,"read from private field"),s?s.call(t):e.get(t)),Y=(t,e,s)=>e.has(t)?B("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),z=(t,e,s,i)=>(_(t,e,"write to private field"),i?i.call(t,s):e.set(t,s),s),G=(t,e,s)=>(_(t,e,"access private method"),s);import{m as H,n as J,o as U,R as X,p as Z,e as tt,c as et,b as st,q as it,L as at,l as nt,r as ht,T as lt,Q as rt}from"./main-ivqbj34p.js";import{E as ct}from"./vidstack-FldwQc2Q-D_7Mk-Sh.js";import{resolveVimeoVideoId as ot,getVimeoVideoInfo as ut}from"./vidstack-krOAtKMi-D_Y3qhEg.js";import"./vendor-I5pfZzyJ.js";import"./mui-Du5OpAyb.js";import"./router-C70wdWFB.js";const dt=["bufferend","bufferstart","durationchange","ended","enterpictureinpicture","error","fullscreenchange","leavepictureinpicture","loaded","playProgress","loadProgress","pause","play","playbackratechange","qualitychange","seeked","seeking","timeupdate","volumechange","waiting"];class ft extends ct{constructor(f,p){super(f),Y(this,d),N(this,"$$PROVIDER_TYPE","VIMEO"),N(this,"scope",H()),N(this,"fullscreen"),Y(this,t),Y(this,e,J("")),Y(this,s,J(!1)),Y(this,i,null),Y(this,a,null),Y(this,n,!1),Y(this,h,new U(0,0)),Y(this,l,new X(G(this,d,y).bind(this))),Y(this,r,null),Y(this,c,null),Y(this,o,new Map),Y(this,u,null),N(this,"cookies",!1),N(this,"title",!0),N(this,"byline",!0),N(this,"portrait",!0),N(this,"color","00ADEF"),Y(this,k,!1),z(this,t,p);const g=this;this.fullscreen={get active(){return K(g,n)},supported:!0,enter:()=>G(this,d,D).call(this,"requestFullscreen"),exit:()=>G(this,d,D).call(this,"exitFullscreen")}}get type(){return"vimeo"}get currentSrc(){return K(this,a)}get videoId(){return K(this,e).call(this)}get hash(){return K(this,i)}get isPro(){return K(this,s).call(this)}preconnect(){Z(this.getOrigin())}setup(){super.setup(),tt(G(this,d,f).bind(this)),tt(G(this,d,p).bind(this)),tt(G(this,d,g).bind(this)),K(this,t).notify("provider-setup",this)}destroy(){G(this,d,S).call(this),this.fullscreen=void 0;for(const t of K(this,o).values())for(const{reject:e}of t)e("provider destroyed");K(this,o).clear(),G(this,d,D).call(this,"destroy")}async play(){return G(this,d,D).call(this,"play")}async pause(){return G(this,d,D).call(this,"pause")}setMuted(t){G(this,d,D).call(this,"setMuted",t)}setCurrentTime(e){G(this,d,D).call(this,"seekTo",e),K(this,t).notify("seeking",e)}setVolume(e){G(this,d,D).call(this,"setVolume",e),G(this,d,D).call(this,"setMuted",et(K(this,t).$state.muted))}setPlaybackRate(t){G(this,d,D).call(this,"setPlaybackRate",t)}async loadSource(t){if(!st(t.src))return z(this,a,null),z(this,i,null),void K(this,e).set("");const{videoId:s,hash:n}=ot(t.src);K(this,e).set(s??""),z(this,i,n??null),z(this,a,t)}getOrigin(){return"https://player.vimeo.com"}buildParams(){const{keyDisabled:e}=K(this,t).$props,{playsInline:s,nativeControls:i}=K(this,t).$state,a=i();return{title:this.title,byline:this.byline,color:this.color,portrait:this.portrait,controls:a,h:this.hash,keyboard:a&&!e(),transparent:!0,playsinline:s(),dnt:!this.cookies}}onMessage(t,e){t.event?G(this,d,I).call(this,t.event,t.data,e):t.method&&G(this,d,M).call(this,t.method,t.value,e)}onLoad(){}}t=new WeakMap,e=new WeakMap,s=new WeakMap,i=new WeakMap,a=new WeakMap,n=new WeakMap,h=new WeakMap,l=new WeakMap,r=new WeakMap,c=new WeakMap,o=new WeakMap,u=new WeakMap,d=new WeakSet,f=function(){G(this,d,S).call(this);const s=K(this,e).call(this);s?(this.src.set(`${this.getOrigin()}/video/${s}`),K(this,t).notify("load-start")):this.src.set("")},p=function(){const t=K(this,e).call(this);if(!t)return;const s=it(),a=new AbortController;return z(this,u,s),ut(t,a,K(this,i)).then(t=>{s.resolve(t)}).catch(t=>{s.reject()}),()=>{s.reject(),a.abort()}},g=function(){const e=K(this,s).call(this),{$state:i,qualities:a}=K(this,t);if(i.canSetPlaybackRate.set(e),a[at.setReadonly](!e),e)return nt(a,"change",()=>{var t;if(a.auto)return;const e=null==(t=a.selected)?void 0:t.id;e&&G(this,d,D).call(this,"setQuality",e)})},y=function(){G(this,d,D).call(this,"getCurrentTime")},k=new WeakMap,b=function(e,s){if(K(this,k)&&0===e)return;const{realCurrentTime:i,paused:a,bufferedEnd:n,seekableEnd:h,live:l}=K(this,t).$state;if(i()===e)return;const r=i();K(this,t).notify("time-change",e,s),Math.abs(r-e)>1.5&&(K(this,t).notify("seeking",e,s),!a()&&n()<e&&K(this,t).notify("waiting",void 0,s)),!l()&&h()-e<.01&&(K(this,t).notify("end",void 0,s),z(this,k,!0),setTimeout(()=>{z(this,k,!1)},500))},v=function(e,s){K(this,t).notify("seeked",e,s)},m=function(i){var a;const n=K(this,e).call(this);null==(a=K(this,u))||a.promise.then(e=>{if(!e)return;const{title:a,poster:n,duration:h,pro:l}=e;K(this,s).set(l),K(this,t).notify("title-change",a,i),K(this,t).notify("poster-change",n,i),K(this,t).notify("duration-change",h,i),G(this,d,w).call(this,h,i)}).catch(()=>{n===K(this,e).call(this)&&(G(this,d,D).call(this,"getVideoTitle"),G(this,d,D).call(this,"getDuration"))})},w=function(e,s){const{nativeControls:i}=K(this,t).$state,a=i();z(this,h,new U(0,e));const n={buffered:new U(0,0),seekable:K(this,h),duration:e};K(this,t).delegate.ready(n,s),a||G(this,d,D).call(this,"_hideOverlay"),G(this,d,D).call(this,"getQualities"),G(this,d,D).call(this,"getChapters")},M=function(e,s,i){var a;switch(e){case"getVideoTitle":const e=s;K(this,t).notify("title-change",e,i);break;case"getDuration":const a=s;K(this,t).$state.canPlay()?K(this,t).notify("duration-change",a,i):G(this,d,w).call(this,a,i);break;case"getCurrentTime":G(this,d,b).call(this,s,i);break;case"getBuffered":ht(s)&&s.length&&G(this,d,C).call(this,s[s.length-1][1],i);break;case"setMuted":G(this,d,R).call(this,et(K(this,t).$state.volume),s,i);break;case"getChapters":G(this,d,O).call(this,s);break;case"getQualities":G(this,d,V).call(this,s,i)}null==(a=G(this,d,F).call(this,e))||a.resolve()},T=function(){for(const t of dt)G(this,d,D).call(this,"addEventListener",t)},$=function(e){K(this,l).stop(),K(this,t).notify("pause",void 0,e)},W=function(e){K(this,l).start(),K(this,t).notify("play",void 0,e)},P=function(e){const{paused:s}=K(this,t).$state;s()||K(this,k)||K(this,t).notify("playing",void 0,e)},C=function(e,s){const i={buffered:new U(0,e),seekable:K(this,h)};K(this,t).notify("progress",i,s)},j=function(e){K(this,t).notify("waiting",void 0,e)},q=function(e){const{paused:s}=K(this,t).$state;s()||K(this,t).notify("playing",void 0,e)},E=function(e){const{paused:s}=K(this,t).$state;s()&&K(this,t).notify("play",void 0,e),K(this,t).notify("waiting",void 0,e)},R=function(e,s,i){const a={volume:e,muted:s};K(this,t).notify("volume-change",a,i)},O=function(e){if(G(this,d,Q).call(this),!e.length)return;const s=new lt({kind:"chapters",default:!0}),{seekableEnd:i}=K(this,t).$state;for(let t=0;t<e.length;t++){const a=e[t],n=e[t+1];s.addCue(new window.VTTCue(a.startTime,(null==n?void 0:n.startTime)??i(),a.title))}z(this,c,s),K(this,t).textTracks.add(s)},Q=function(){K(this,c)&&(K(this,t).textTracks.remove(K(this,c)),z(this,c,null))},V=function(e,s){K(this,t).qualities[rt.enableAuto]=e.some(t=>"auto"===t.id)?()=>G(this,d,D).call(this,"setQuality","auto"):void 0;for(const i of e){if("auto"===i.id)continue;const e=+i.id.slice(0,-1);isNaN(e)||K(this,t).qualities[at.add]({id:i.id,width:e*(16/9),height:e,codec:"avc1,h.264",bitrate:-1},s)}G(this,d,x).call(this,e.find(t=>t.active),s)},x=function({id:e}={},s){if(!e)return;const i="auto"===e,a=K(this,t).qualities.getById(e);i?(K(this,t).qualities[rt.setAuto](i,s),K(this,t).qualities[at.select](void 0,!0,s)):K(this,t).qualities[at.select](a??void 0,!0,s)},I=function(e,s,i){switch(e){case"ready":G(this,d,T).call(this);break;case"loaded":G(this,d,m).call(this,i);break;case"play":G(this,d,W).call(this,i);break;case"playProgress":G(this,d,P).call(this,i);break;case"pause":G(this,d,$).call(this,i);break;case"loadProgress":G(this,d,C).call(this,s.seconds,i);break;case"waiting":G(this,d,E).call(this,i);break;case"bufferstart":G(this,d,j).call(this,i);break;case"bufferend":G(this,d,q).call(this,i);break;case"volumechange":G(this,d,R).call(this,s.volume,et(K(this,t).$state.muted),i);break;case"durationchange":z(this,h,new U(0,s.duration)),K(this,t).notify("duration-change",s.duration,i);break;case"playbackratechange":K(this,t).notify("rate-change",s.playbackRate,i);break;case"qualitychange":G(this,d,x).call(this,s,i);break;case"fullscreenchange":z(this,n,s.fullscreen),K(this,t).notify("fullscreen-change",s.fullscreen,i);break;case"enterpictureinpicture":K(this,t).notify("picture-in-picture-change",!0,i);break;case"leavepictureinpicture":K(this,t).notify("picture-in-picture-change",!1,i);break;case"ended":K(this,t).notify("end",void 0,i);break;case"error":G(this,d,A).call(this,s,i);break;case"seek":case"seeked":G(this,d,v).call(this,s.seconds,i)}},A=function(t,e){var i;const{message:a,method:n}=t;"setPlaybackRate"===n&&K(this,s).set(!1),n&&(null==(i=G(this,d,F).call(this,n))||i.reject(a))},D=async function(t,e){let s=it(),i=K(this,o).get(t);return i||K(this,o).set(t,i=[]),i.push(s),this.postMessage({method:t,value:e}),s.promise},S=function(){K(this,l).stop(),z(this,h,new U(0,0)),z(this,u,null),z(this,r,null),K(this,s).set(!1),G(this,d,Q).call(this)},F=function(t){var e;return null==(e=K(this,o).get(t))?void 0:e.shift()};export{ft as VimeoProvider};
